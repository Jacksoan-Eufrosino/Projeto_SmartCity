{
  "id": null,
  "title": "Smart City IoT \u2014 Overview",
  "tags": [
    "iot",
    "smartcity"
  ],
  "timezone": "browser",
  "schemaVersion": 39,
  "version": 1,
  "refresh": "5s",
  "panels": [
    {
      "type": "timeseries",
      "title": "E2E Latency p95 by App",
      "gridPos": {
        "x": 0,
        "y": 0,
        "w": 12,
        "h": 8
      },
      "targets": [
        {
          "refId": "A",
          "expr": "histogram_quantile(0.95, sum(rate(iot_e2e_latency_seconds_bucket[1m])) by (le, app))",
          "legendFormat": "{{app}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Throughput \u2014 Messages Received by App (msg/s)",
      "gridPos": {
        "x": 12,
        "y": 0,
        "w": 12,
        "h": 8
      },
      "targets": [
        {
          "refId": "A",
          "expr": "sum(rate(iot_messages_received_total[1m])) by (app)",
          "legendFormat": "{{app}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Messages Sent (Devices) \u2014 msg/s",
      "gridPos": {
        "x": 0,
        "y": 8,
        "w": 12,
        "h": 8
      },
      "targets": [
        {
          "refId": "A",
          "expr": "sum(rate(iot_messages_sent_total[1m])) by (device)",
          "legendFormat": "{{device}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Container CPU (devices)",
      "gridPos": {
        "x": 12,
        "y": 8,
        "w": 12,
        "h": 8
      },
      "targets": [
        {
          "refId": "A",
          "expr": "sum(rate(container_cpu_usage_seconds_total{container_label_com_docker_compose_service=~\"device_.*\"}[1m])) by (container_label_com_docker_compose_service)",
          "legendFormat": "{{container_label_com_docker_compose_service}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Container Memory (devices)",
      "gridPos": {
        "x": 0,
        "y": 16,
        "w": 12,
        "h": 8
      },
      "targets": [
        {
          "refId": "A",
          "expr": "container_memory_working_set_bytes{container_label_com_docker_compose_service=~\"device_.*\"}",
          "legendFormat": "{{container_label_com_docker_compose_service}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Container Network I/O (RX) \u2014 devices",
      "gridPos": {
        "x": 12,
        "y": 16,
        "w": 12,
        "h": 8
      },
      "targets": [
        {
          "refId": "A",
          "expr": "sum(rate(container_network_receive_bytes_total{container_label_com_docker_compose_service=~\"device_.*\"}[1m])) by (container_label_com_docker_compose_service)",
          "legendFormat": "RX {{container_label_com_docker_compose_service}}"
        }
      ]
    }
  ],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-15m",
    "to": "now"
  }
}